<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üá™üá∏ Spaans ‚Üî Nederlands Leren üá≥üá±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f2f2f2;
            color: #1a1a1a;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            text-align: center;
        }

        h1 {
            font-size: 28px;
            margin-bottom: 15px;
            color: #1a1a1a;
        }

        .direction-toggle {
            display: inline-flex;
            gap: 10px;
            background: #f2f2f2;
            padding: 8px;
            border-radius: 12px;
            margin-bottom: 15px;
        }

        .direction-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .direction-btn.active {
            background: #1a1a1a;
            color: white;
        }

        .tabs {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            background: #e0e0e0;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .tab-btn.active {
            background: #1a1a1a;
            color: white;
        }

        .tab-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .content {
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            min-height: 400px;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { 
                opacity: 0;
                transform: translateY(20px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        input[type="text"], select {
            flex: 1;
            min-width: 200px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        input[type="text"]:focus, select:focus {
            outline: none;
            border-color: #1a1a1a;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background: #f8f8f8;
            font-weight: 600;
        }

        .favorite-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 20px;
            transition: transform 0.2s ease;
        }

        .favorite-btn:hover {
            transform: scale(1.2);
        }

        .flashcard {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px 40px;
            border-radius: 20px;
            text-align: center;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.3s ease;
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
        }

        .flashcard:hover {
            transform: scale(1.02);
        }

        .flashcard-text {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .flashcard-hint {
            font-size: 16px;
            opacity: 0.9;
        }

        .flashcard-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .btn-primary {
            background: #1a1a1a;
            color: white;
        }

        .btn-primary:hover {
            background: #333;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #1a1a1a;
        }

        .btn-secondary:hover {
            background: #d0d0d0;
        }

        .typing-question {
            text-align: center;
            margin-bottom: 30px;
        }

        .typing-question h2 {
            font-size: 36px;
            margin-bottom: 10px;
            color: #667eea;
        }

        .typing-input {
            width: 100%;
            max-width: 500px;
            padding: 15px;
            font-size: 20px;
            border: 3px solid #e0e0e0;
            border-radius: 12px;
            text-align: center;
            margin: 20px auto;
            display: block;
        }

        .feedback {
            padding: 15px;
            border-radius: 12px;
            margin: 20px 0;
            text-align: center;
            font-size: 18px;
            font-weight: 500;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
        }

        .quiz-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 30px 0;
        }

        .quiz-option {
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 18px;
        }

        .quiz-option:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }

        .quiz-option.correct {
            background: #d4edda;
            border-color: #28a745;
        }

        .quiz-option.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: #f8f8f8;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            h1 {
                font-size: 22px;
            }

            .content {
                padding: 20px;
            }

            .flashcard-text {
                font-size: 24px;
            }

            .typing-question h2 {
                font-size: 28px;
            }

            table {
                font-size: 14px;
            }

            th, td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üá™üá∏ Spaans ‚Üî Nederlands Leren üá≥üá±</h1>
            
            <div class="direction-toggle">
                <button class="direction-btn active" data-direction="es-nl">üá™üá∏ ‚Üí üá≥üá±</button>
                <button class="direction-btn" data-direction="nl-es">üá≥üá± ‚Üí üá™üá∏</button>
            </div>

            <div class="tabs">
                <button class="tab-btn active" data-tab="learn">üìö Learn</button>
                <button class="tab-btn" data-tab="flashcards">üÉè Flashcards</button>
                <button class="tab-btn" data-tab="typing">‚å®Ô∏è Typing</button>
                <button class="tab-btn" data-tab="quiz">üß† Quiz</button>
                <button class="tab-btn" data-tab="stats">üìä Stats</button>
            </div>
        </header>

        <div class="content">
            <!-- Learn Tab -->
            <div id="learn-tab" class="tab-content">
                <div class="controls">
                    <input type="text" id="search-input" placeholder="üîç Zoeken...">
                    <select id="category-filter">
                        <option value="">Alle categorie√´n</option>
                    </select>
                    <button class="btn btn-secondary" id="favorites-filter">‚ù§Ô∏è Favorieten</button>
                </div>
                <table id="words-table">
                    <thead>
                        <tr>
                            <th>üá™üá∏ Spaans</th>
                            <th>üá≥üá± Nederlands</th>
                            <th>üìÅ Categorie</th>
                            <th>‚ù§Ô∏è</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>

            <!-- Flashcards Tab -->
            <div id="flashcards-tab" class="tab-content hidden">
                <div class="flashcard" id="flashcard">
                    <div class="flashcard-text" id="flashcard-text"></div>
                    <div class="flashcard-hint">Klik om te zien</div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="flashcard-progress"></div>
                </div>
                <p style="text-align: center; margin: 10px 0;" id="flashcard-counter"></p>
                <div class="flashcard-controls">
                    <button class="btn btn-secondary" id="flashcard-prev">‚¨ÖÔ∏è Vorige</button>
                    <button class="btn btn-primary" id="flashcard-next">Volgende ‚û°Ô∏è</button>
                </div>
            </div>

            <!-- Typing Tab -->
            <div id="typing-tab" class="tab-content hidden">
                <div class="typing-question">
                    <p style="color: #666; margin-bottom: 10px;" id="typing-category"></p>
                    <h2 id="typing-word"></h2>
                    <input type="text" class="typing-input" id="typing-input" placeholder="Type de vertaling...">
                </div>
                <div id="typing-feedback"></div>
                <div class="progress-bar">
                    <div class="progress-fill" id="typing-progress"></div>
                </div>
                <p style="text-align: center; margin: 10px 0;" id="typing-counter"></p>
                <div style="text-align: center;">
                    <button class="btn btn-primary" id="typing-check">Controleer</button>
                    <button class="btn btn-secondary hidden" id="typing-next">Volgende</button>
                </div>
            </div>

            <!-- Quiz Tab -->
            <div id="quiz-tab" class="tab-content hidden">
                <div class="typing-question">
                    <p style="color: #666; margin-bottom: 10px;" id="quiz-category"></p>
                    <h2 id="quiz-word"></h2>
                </div>
                <div class="quiz-options" id="quiz-options"></div>
                <div id="quiz-feedback"></div>
                <div class="progress-bar">
                    <div class="progress-fill" id="quiz-progress"></div>
                </div>
                <p style="text-align: center; margin: 10px 0;" id="quiz-counter"></p>
                <div style="text-align: center;">
                    <button class="btn btn-primary hidden" id="quiz-next">Volgende</button>
                </div>
            </div>

            <!-- Stats Tab -->
            <div id="stats-tab" class="tab-content hidden">
                <h2 style="margin-bottom: 20px;">üìä Statistieken</h2>
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-value" id="stat-total">0</div>
                        <div class="stat-label">Totaal woorden</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-favorites">0</div>
                        <div class="stat-label">‚ù§Ô∏è Favorieten</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-practiced">0</div>
                        <div class="stat-label">Geoefend</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="stat-score">0%</div>
                        <div class="stat-label">Gemiddelde score</div>
                    </div>
                </div>
                <div style="margin-top: 30px; text-align: center;">
                    <button class="btn btn-secondary" id="reset-stats">Reset statistieken</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data
        const data = [
            // Bron A en B
            {cat:"Bron A en B", es:"hola", nl:"hallo"},
            {cat:"Bron A en B", es:"bien", nl:"goed"},
            {cat:"Bron A en B", es:"no", nl:"nee"},
            {cat:"Bron A en B", es:"s√≠", nl:"ja/wel"},
            {cat:"Bron A en B", es:"la piscina", nl:"het zwembad"},
            {cat:"Bron A en B", es:"el camping", nl:"de camping"},
            {cat:"Bron A en B", es:"me llamo", nl:"ik heet"},
            {cat:"Bron A en B", es:"hablas", nl:"je spreekt"},
            {cat:"Bron A en B", es:"vas", nl:"je gaat"},
            {cat:"Bron A en B", es:"voy", nl:"ik ga"},
            {cat:"Bron A en B", es:"¬øY t√∫?", nl:"En jij?"},
            
            // Bron F, G en H
            {cat:"Bron F, G en H", es:"buenas noches", nl:"goedenavond"},
            {cat:"Bron F, G en H", es:"hasta luego", nl:"tot ziens"},
            {cat:"Bron F, G en H", es:"bien hecho", nl:"goed gedaan"},
            {cat:"Bron F, G en H", es:"primero/-a", nl:"eerste"},
            {cat:"Bron F, G en H", es:"√∫ltimo/-a", nl:"laatste"},
            {cat:"Bron F, G en H", es:"cerca de", nl:"vlakbij, dichtbij"},
            {cat:"Bron F, G en H", es:"cantar", nl:"zingen"},
            {cat:"Bron F, G en H", es:"el presentador", nl:"de presentator"},
            {cat:"Bron F, G en H", es:"el participante", nl:"de deelnemer"},
            {cat:"Bron F, G en H", es:"la participante", nl:"de deelneemster"},
            {cat:"Bron F, G en H", es:"la canci√≥n", nl:"het liedje"},
            {cat:"Bron F, G en H", es:"la canci√≥n preferida", nl:"het lievelingsliedje"},
            {cat:"Bron F, G en H", es:"el n√∫mero de tel√©fono", nl:"het telefoonnummer"},
            {cat:"Bron F, G en H", es:"el hijo", nl:"de zoon"},
            {cat:"Bron F, G en H", es:"la hija", nl:"de dochter"},
            {cat:"Bron F, G en H", es:"vamos", nl:"wij gaan"},
            {cat:"Bron F, G en H", es:"va", nl:"gaat"},
            {cat:"Bron F, G en H", es:"voy", nl:"ik ga"},
            {cat:"Bron F, G en H", es:"soy", nl:"ik ben"},
            {cat:"Bron F, G en H", es:"es", nl:"hij/zij is, u bent"},
            {cat:"Bron F, G en H", es:"verde", nl:"groen"},
            {cat:"Bron F, G en H", es:"violeta", nl:"paars"},
            {cat:"Bron F, G en H", es:"ingl√©s", nl:"Engels"},
            {cat:"Bron F, G en H", es:"rosa", nl:"roze"},
            
            // Bron C
            {cat:"Bron C", es:"marr√≥n", nl:"bruin"},
            {cat:"Bron C", es:"naranja", nl:"oranje"},
            {cat:"Bron C", es:"gris", nl:"grijs"},
            {cat:"Bron C", es:"¬øQu√© tal?", nl:"Hoe gaat het?"},
            {cat:"Bron C", es:"hasta pronto", nl:"tot gauw"},
            {cat:"Bron C", es:"buenos d√≠as", nl:"goedendag"},
            {cat:"Bron C", es:"azul", nl:"blauw"},
            {cat:"Bron C", es:"amarillo", nl:"geel"},
            {cat:"Bron C", es:"negro", nl:"zwart"},
            {cat:"Bron C", es:"¬ød√≥nde?", nl:"waar?"},
            {cat:"Bron C", es:"yo", nl:"ik"},
            {cat:"Bron C", es:"muy", nl:"heel, erg"},
            {cat:"Bron C", es:"tambi√©n", nl:"ook"},
            {cat:"Bron C", es:"fant√°stico", nl:"fantastisch"},
            {cat:"Bron C", es:"grande", nl:"groot"},
            {cat:"Bron C", es:"en Barcelona", nl:"in Barcelona"},
            {cat:"Bron C", es:"el chico", nl:"de jongen"},
            {cat:"Bron C", es:"la chica", nl:"het meisje"},
            {cat:"Bron C", es:"el amigo", nl:"de vriend"},
            {cat:"Bron C", es:"la amiga", nl:"de vriendin"},
            {cat:"Bron C", es:"la hermana", nl:"de zus"},
            {cat:"Bron C", es:"el hermano", nl:"de broer"},
            {cat:"Bron C", es:"la tienda", nl:"de tent"},
            {cat:"Bron C", es:"las vacaciones", nl:"de vakantie"},
            {cat:"Bron C", es:"la ciudad", nl:"de stad"},
            {cat:"Bron C", es:"el pueblo", nl:"het dorp"},
            {cat:"Bron C", es:"tengo", nl:"ik heb"},
            {cat:"Bron C", es:"tenemos", nl:"wij hebben"},
            {cat:"Bron C", es:"tiene 14 a√±os", nl:"hij/zij is 14 jaar"},
            {cat:"Bron C", es:"tengo 15 a√±os", nl:"ik ben 15 jaar"},
            {cat:"Bron C", es:"vivo en", nl:"ik woon in"},
            {cat:"Bron C", es:"se llama", nl:"hij/zij heet"},
            {cat:"Bron C", es:"te llamas", nl:"jij heet"},
            
            // Landen en talen
            {cat:"Landen en talen", es:"negro", nl:"zwart"},
            {cat:"Landen en talen", es:"blanco", nl:"wit"},
            {cat:"Landen en talen", es:"rojo", nl:"rood"},
            {cat:"Landen en talen", es:"Holanda", nl:"Nederland"},
            {cat:"Landen en talen", es:"holand√©s/holandesa", nl:"Nederlander/Nederlandse"},
            {cat:"Landen en talen", es:"Inglaterra", nl:"Engeland"},
            {cat:"Landen en talen", es:"ingl√©s/inglesa", nl:"Engelsman/Engelse"},
            {cat:"Landen en talen", es:"Espa√±a", nl:"Spanje"},
            {cat:"Landen en talen", es:"espa√±ol/espa√±ola", nl:"Spanjaard/Spaanse"},
            {cat:"Landen en talen", es:"Francia", nl:"Frankrijk"},
            {cat:"Landen en talen", es:"franc√©s/francesa", nl:"Fransman/Fran√ßaise"},
            {cat:"Landen en talen", es:"Alemania", nl:"Duitsland"},
            {cat:"Landen en talen", es:"alem√°n/alemana", nl:"Duitser/Duitse"},
            {cat:"Landen en talen", es:"M√©xico", nl:"Mexico"},
            {cat:"Landen en talen", es:"mexicano/mexicana", nl:"Mexicaan/Mexicaanse"},
            {cat:"Landen en talen", es:"Italia", nl:"Itali√´"},
            {cat:"Landen en talen", es:"italiano/italiana", nl:"Italiaan/Italiaanse"},
            {cat:"Landen en talen", es:"s√≠", nl:"ja"},
            {cat:"Landen en talen", es:"no", nl:"nee"},
            
            // Frases clave
            {cat:"Frases clave", es:"¬øQu√© tal?", nl:"Hoe gaat het?"},
            {cat:"Frases clave", es:"¬øC√≥mo te llamas?", nl:"Hoe heet je?"},
            {cat:"Frases clave", es:"¬øEres espa√±ol/espa√±ola?", nl:"Ben jij Spaans/Spaanse?"},
            {cat:"Frases clave", es:"¬øHablas espa√±ol?", nl:"Spreek je Spaans?"},
            {cat:"Frases clave", es:"Muy bien", nl:"Heel goed"},
            {cat:"Frases clave", es:"Me llamo Bart", nl:"Ik heet Bart"},
            {cat:"Frases clave", es:"No, soy holand√©s/holandesa", nl:"Nee, ik ben Nederlander/Nederlandse"},
            {cat:"Frases clave", es:"No, hablo holand√©s", nl:"Nee, ik spreek Nederlands"},
            {cat:"Frases clave", es:"¬øD√≥nde vives?", nl:"Waar woon je?"},
            {cat:"Frases clave", es:"¬øEs un pueblo?", nl:"Is het een dorp?"},
            {cat:"Frases clave", es:"¬øD√≥nde est√°?", nl:"Waar ligt dat?"},
            {cat:"Frases clave", es:"¬øCu√°ntos a√±os tienes?", nl:"Hoe oud ben je?"},
            {cat:"Frases clave", es:"¬øCu√°l es tu n√∫mero de tel√©fono?", nl:"Wat is je telefoonnummer?"},
            {cat:"Frases clave", es:"Vivo en Gerona, est√° en Espa√±a", nl:"Ik woon in Gerona, dat ligt in Spanje"},
            {cat:"Frases clave", es:"No, es una ciudad", nl:"Nee, het is een stad"},
            {cat:"Frases clave", es:"Cerca de Barcelona", nl:"Vlakbij Barcelona"},
            {cat:"Frases clave", es:"Tengo 14 a√±os", nl:"Ik ben 14 jaar"},
            {cat:"Frases clave", es:"Es el 06 09 10 07 03 06", nl:"Dat is 06 09 10 07 03 06"}
        ];

        // State
        let direction = 'es-nl'; // 'es-nl' or 'nl-es'
        let currentTab = 'learn';
        let favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
        let stats = JSON.parse(localStorage.getItem('stats') || '{"practiced": 0, "correct": 0, "total": 0}');
        let showOnlyFavorites = false;

        // Flashcard state
        let flashcardIndex = 0;
        let flashcardRevealed = false;

        // Typing state
        let typingIndex = 0;
        let typingWords = [];

        // Quiz state
        let quizIndex = 0;
        let quizWords = [];
        let quizScore = 0;

        // Initialize
        function init() {
            populateCategoryFilter();
            renderLearnTab();
            updateStats();
            attachEventListeners();
        }

        function attachEventListeners() {
            // Direction toggle
            document.querySelectorAll('.direction-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    direction = btn.dataset.direction;
                    document.querySelectorAll('.direction-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    renderLearnTab();
                    if (currentTab === 'flashcards') initFlashcards();
                    if (currentTab === 'typing') initTyping();
                    if (currentTab === 'quiz') initQuiz();
                });
            });

            // Tab switching
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    currentTab = btn.dataset.tab;
                    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    showTab(currentTab);
                });
            });

            // Learn tab
            document.getElementById('search-input').addEventListener('input', renderLearnTab);
            document.getElementById('category-filter').addEventListener('change', renderLearnTab);
            document.getElementById('favorites-filter').addEventListener('click', () => {
                showOnlyFavorites = !showOnlyFavorites;
                document.getElementById('favorites-filter').style.background = showOnlyFavorites ? '#1a1a1a' : '#e0e0e0';
                document.getElementById('favorites-filter').style.color = showOnlyFavorites ? 'white' : '#1a1a1a';
                renderLearnTab();
            });

            // Flashcards
            document.getElementById('flashcard').addEventListener('click', toggleFlashcard);
            document.getElementById('flashcard-next').addEventListener('click', nextFlashcard);
            document.getElementById('flashcard-prev').addEventListener('click', prevFlashcard);

            // Typing
            document.getElementById('typing-check').addEventListener('click', checkTyping);
            document.getElementById('typing-next').addEventListener('click', nextTyping);
            document.getElementById('typing-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') checkTyping();
            });

            // Quiz
            document.getElementById('quiz-next').addEventListener('click', nextQuiz);

            // Stats
            document.getElementById('reset-stats').addEventListener('click', resetStats);
        }

        function showTab(tab) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
            document.getElementById(`${tab}-tab`).classList.remove('hidden');

            if (tab === 'flashcards') initFlashcards();
            if (tab === 'typing') initTyping();
            if (tab === 'quiz') initQuiz();
            if (tab === 'stats') updateStats();
        }

        function populateCategoryFilter() {
            const categories = [...new Set(data.map(item => item.cat))];
            const select = document.getElementById('category-filter');
            categories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                select.appendChild(option);
            });
        }

        function getFilteredData() {
            let filtered = data;
            
            const search = document.getElementById('search-input').value.toLowerCase();
            const category = document.getElementById('category-filter').value;
            
            if (search) {
                filtered = filtered.filter(item => 
                    item.es.toLowerCase().includes(search) || 
                    item.nl.toLowerCase().includes(search)
                );
            }
            
            if (category) {
                filtered = filtered.filter(item => item.cat === category);
            }
            
            if (showOnlyFavorites) {
                filtered = filtered.filter(item => favorites.includes(`${item.es}-${item.nl}`));
            }
            
            return filtered;
        }

        function renderLearnTab() {
            const tbody = document.querySelector('#words-table tbody');
            tbody.innerHTML = '';
            
            const filtered = getFilteredData();
            
            filtered.forEach(item => {
                const row = document.createElement('tr');
                const id = `${item.es}-${item.nl}`;
                const isFavorite = favorites.includes(id);
                
                if (direction === 'es-nl') {
                    row.innerHTML = `
                        <td>${item.es}</td>
                        <td>${item.nl}</td>
                        <td>${item.cat}</td>
                        <td><button class="favorite-btn" data-id="${id}">${isFavorite ? '‚ù§Ô∏è' : 'ü§ç'}</button></td>
                    `;
                } else {
                    row.innerHTML = `
                        <td>${item.nl}</td>
                        <td>${item.es}</td>
                        <td>${item.cat}</td>
                        <td><button class="favorite-btn" data-id="${id}">${isFavorite ? '‚ù§Ô∏è' : 'ü§ç'}</button></td>
                    `;
                }
                
                tbody.appendChild(row);
            });
            
            // Update table headers
            const headers = document.querySelectorAll('#words-table th');
            if (direction === 'es-nl') {
                headers[0].textContent = 'üá™üá∏ Spaans';
                headers[1].textContent = 'üá≥üá± Nederlands';
            } else {
                headers[0].textContent = 'üá≥üá± Nederlands';
                headers[1].textContent = 'üá™üá∏ Spaans';
            }
            
            // Attach favorite listeners
            document.querySelectorAll('.favorite-btn').forEach(btn => {
                btn.addEventListener('click', () => toggleFavorite(btn.dataset.id, btn));
            });
        }

        function toggleFavorite(id, btn) {
            if (favorites.includes(id)) {
                favorites = favorites.filter(f => f !== id);
                btn.textContent = 'ü§ç';
            } else {
                favorites.push(id);
                btn.textContent = '‚ù§Ô∏è';
            }
            localStorage.setItem('favorites', JSON.stringify(favorites));
            updateStats();
        }

        // Flashcards
        function initFlashcards() {
            flashcardIndex = 0;
            flashcardRevealed = false;
            showFlashcard();
        }

        function showFlashcard() {
            const filtered = getFilteredData();
            if (filtered.length === 0) {
                document.getElementById('flashcard-text').textContent = 'Geen woorden gevonden';
                return;
            }
            
            const item = filtered[flashcardIndex];
            const text = direction === 'es-nl' ? item.es : item.nl;
            
            document.getElementById('flashcard-text').textContent = text;
            document.querySelector('.flashcard-hint').textContent = flashcardRevealed ? '' : 'Klik om te zien';
            
            const progress = ((flashcardIndex + 1) / filtered.length) * 100;
            document.getElementById('flashcard-progress').style.width = progress + '%';
            document.getElementById('flashcard-counter').textContent = `Kaart ${flashcardIndex + 1} van ${filtered.length}`;
            
            flashcardRevealed = false;
        }

        function toggleFlashcard() {
            const filtered = getFilteredData();
            if (filtered.length === 0) return;
            
            const item = filtered[flashcardIndex];
            
            if (!flashcardRevealed) {
                const translation = direction === 'es-nl' ? item.nl : item.es;
                document.getElementById('flashcard-text').textContent = translation;
                document.querySelector('.flashcard-hint').textContent = '';
                flashcardRevealed = true;
            }
        }

        function nextFlashcard() {
            const filtered = getFilteredData();
            flashcardIndex = (flashcardIndex + 1) % filtered.length;
            showFlashcard();
        }

        function prevFlashcard() {
            const filtered = getFilteredData();
            flashcardIndex = (flashcardIndex - 1 + filtered.length) % filtered.length;
            showFlashcard();
        }

        // Typing
        function initTyping() {
            typingWords = shuffleArray([...getFilteredData()]);
            typingIndex = 0;
            showTypingQuestion();
        }

        function showTypingQuestion() {
            if (typingIndex >= typingWords.length) {
                document.getElementById('typing-word').textContent = '‚úÖ Klaar!';
                document.getElementById('typing-category').textContent = '';
                document.getElementById('typing-input').style.display = 'none';
                document.getElementById('typing-check').style.display = 'none';
                return;
            }
            
            const item = typingWords[typingIndex];
            const word = direction === 'es-nl' ? item.es : item.nl;
            
            document.getElementById('typing-word').textContent = word;
            document.getElementById('typing-category').textContent = item.cat;
            document.getElementById('typing-input').value = '';
            document.getElementById('typing-input').style.display = 'block';
            document.getElementById('typing-feedback').innerHTML = '';
            document.getElementById('typing-check').classList.remove('hidden');
            document.getElementById('typing-next').classList.add('hidden');
            
            const progress = (typingIndex / typingWords.length) * 100;
            document.getElementById('typing-progress').style.width = progress + '%';
            document.getElementById('typing-counter').textContent = `Vraag ${typingIndex + 1} van ${typingWords.length}`;
        }

        function checkTyping() {
            const item = typingWords[typingIndex];
            const answer = direction === 'es-nl' ? item.nl : item.es;
            const userAnswer = document.getElementById('typing-input').value.trim().toLowerCase();
            const correctAnswer = answer.toLowerCase();
            
            const feedback = document.getElementById('typing-feedback');
            
            stats.practiced++;
            stats.total++;
            
            if (userAnswer === correctAnswer) {
                feedback.innerHTML = '<div class="feedback correct">‚úÖ Correct!</div>';
                stats.correct++;
            } else {
                feedback.innerHTML = `<div class="feedback incorrect">‚ùå Fout. Juiste antwoord: "${answer}"</div>`;
            }
            
            localStorage.setItem('stats', JSON.stringify(stats));
            
            document.getElementById('typing-check').classList.add('hidden');
            document.getElementById('typing-next').classList.remove('hidden');
        }

        function nextTyping() {
            typingIndex++;
            showTypingQuestion();
        }

        // Quiz
        function initQuiz() {
            quizWords = shuffleArray([...getFilteredData()]);
            quizIndex = 0;
            quizScore = 0;
            showQuizQuestion();
        }

        function showQuizQuestion() {
            if (quizIndex >= quizWords.length) {
                const percentage = Math.round((quizScore / quizWords.length) * 100);
                document.getElementById('quiz-word').textContent = `‚úÖ Klaar! Score: ${quizScore}/${quizWords.length} (${percentage}%)`;
                document.getElementById('quiz-category').textContent = '';
                document.getElementById('quiz-options').innerHTML = '';
                document.getElementById('quiz-next').classList.add('hidden');
                return;
            }
            
            const item = quizWords[quizIndex];
            const word = direction === 'es-nl' ? item.es : item.nl;
            const correctAnswer = direction === 'es-nl' ? item.nl : item.es;
            
            document.getElementById('quiz-word').textContent = word;
            document.getElementById('quiz-category').textContent = item.cat;
            document.getElementById('quiz-feedback').innerHTML = '';
            document.getElementById('quiz-next').classList.add('hidden');
            
            // Generate options
            const options = [correctAnswer];
            const allAnswers = data.map(d => direction === 'es-nl' ? d.nl : d.es);
            while (options.length < 4) {
                const random = allAnswers[Math.floor(Math.random() * allAnswers.length)];
                if (!options.includes(random)) {
                    options.push(random);
                }
            }
            
            shuffleArray(options);
            
            const optionsContainer = document.getElementById('quiz-options');
            optionsContainer.innerHTML = '';
            
            options.forEach(option => {
                const div = document.createElement('div');
                div.className = 'quiz-option';
                div.textContent = option;
                div.addEventListener('click', () => checkQuiz(option, correctAnswer, div));
                optionsContainer.appendChild(div);
            });
            
            const progress = (quizIndex / quizWords.length) * 100;
            document.getElementById('quiz-progress').style.width = progress + '%';
            document.getElementById('quiz-counter').textContent = `Vraag ${quizIndex + 1} van ${quizWords.length}`;
        }

        function checkQuiz(selected, correct, element) {
            const allOptions = document.querySelectorAll('.quiz-option');
            allOptions.forEach(opt => {
                opt.style.pointerEvents = 'none';
                if (opt.textContent === correct) {
                    opt.classList.add('correct');
                }
            });
            
            stats.practiced++;
            stats.total++;
            
            if (selected === correct) {
                element.classList.add('correct');
                document.getElementById('quiz-feedback').innerHTML = '<div class="feedback correct">‚úÖ Correct!</div>';
                quizScore++;
                stats.correct++;
            } else {
                element.classList.add('incorrect');
                document.getElementById('quiz-feedback').innerHTML = `<div class="feedback incorrect">‚ùå Fout. Juiste antwoord: "${correct}"</div>`;
            }
            
            localStorage.setItem('stats', JSON.stringify(stats));
            document.getElementById('quiz-next').classList.remove('hidden');
        }

        function nextQuiz() {
            quizIndex++;
            showQuizQuestion();
        }

        // Stats
        function updateStats() {
            document.getElementById('stat-total').textContent = data.length;
            document.getElementById('stat-favorites').textContent = favorites.length;
            document.getElementById('stat-practiced').textContent = stats.practiced;
            
            const percentage = stats.total > 0 ? Math.round((stats.correct / stats.total) * 100) : 0;
            document.getElementById('stat-score').textContent = percentage + '%';
        }

        function resetStats() {
            if (confirm('Weet je zeker dat je alle statistieken wilt resetten?')) {
                stats = {practiced: 0, correct: 0, total: 0};
                favorites = [];
                localStorage.setItem('stats', JSON.stringify(stats));
                localStorage.setItem('favorites', JSON.stringify(favorites));
                updateStats();
                renderLearnTab();
            }
        }

        // Utility
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Start
        init();
    </script>
</body>
</html>
